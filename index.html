<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–ú–∏–∫—Ä–æ-–ó–û–ñ ‚Äî –¢–µ—Å—Ç</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    :root {
      --primary: #4caf50;
      --primary-dark: #388e3c;
      --light-bg: #f9fbf9;
      --card-bg: #ffffff;
      --text: #2d5a27;
      --text-light: #668b63;
    }
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--light-bg);
      color: var(--text);
      line-height: 1.6;
      padding: 0;
      margin: 0;
    }
    .container {
      max-width: 500px;
      margin: 0 auto;
      padding: 20px;
      min-height: 100vh;
    }
    .screen {
      display: none;
      padding: 25px 0;
      text-align: center;
    }
    .screen.active { display: block; }
    h1 {
      font-size: 28px;
      margin-bottom: 12px;
      color: var(--primary-dark);
    }
    h2 {
      font-size: 22px;
      margin: 20px 0 15px;
    }
    p {
      margin: 12px 0;
      color: var(--text-light);
    }
    .subtitle {
      font-size: 18px;
      margin: 15px 0 25px;
      color: var(--text);
    }
    .card {
      background: var(--card-bg);
      border-radius: 20px;
      padding: 25px;
      margin: 20px 0;
      box-shadow: 0 4px 16px rgba(0,0,0,0.06);
    }
    .task-text {
      font-size: 19px;
      line-height: 1.5;
      margin: 25px 0;
      padding: 16px;
      background: #f0f9f1;
      border-radius: 16px;
      border-left: 4px solid var(--primary);
    }
    .tree-container {
      margin: 20px 0;
    }
    .tree {
      font-size: 80px;
      transition: transform 0.4s ease;
    }
    .tree.grow { transform: scale(1.15); }
    .btn {
      display: inline-block;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 50px;
      padding: 14px 28px;
      font-size: 17px;
      margin: 10px 8px;
      cursor: pointer;
      transition: background 0.2s, transform 0.1s;
      width: 90%;
      max-width: 300px;
    }
    .btn:hover {
      background: var(--primary-dark);
    }
    .btn:active {
      transform: scale(0.97);
    }
    .btn-outline {
      background: transparent;
      border: 2px solid #ccd8cc;
      color: var(--text-light);
    }
    .btn-outline:hover {
      background: #f0f6f0;
    }
    .footer {
      margin-top: 30px;
      font-size: 13px;
      color: #999;
    }
    .icon {
      font-size: 24px;
      margin-bottom: 12px;
      color: var(--primary);
    }
    .habit-map {
      background: #f0f9f1;
      padding: 20px;
      border-radius: 16px;
      margin: 20px 0;
    }
    .habit-item {
      display: flex;
      justify-content: space-between;
      padding: 10px 0;
      border-bottom: 1px dashed #c8e0c8;
    }
    .habit-item:last-child { border: none; }
  </style>
</head>
<body>

<div class="container">
  <!-- –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ -->
  <div id="intro" class="screen active">
    <div class="icon"><i class="fas fa-seedling"></i></div>
    <h1>–ú–∏–∫—Ä–æ-–ó–û–ñ</h1>
    <p class="subtitle">–ó–¥–æ—Ä–æ–≤—ã–π –æ–±—Ä–∞–∑ –∂–∏–∑–Ω–∏ –±–µ–∑ —Å—Ç—Ä–µ—Å—Å–∞</p>
    <div class="card">
      <p>–ó–¥–µ—Å—å –Ω–µ—Ç –¥–∏–µ—Ç, —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –Ω–∞ —á–∞—Å –∏ —á—É–≤—Å—Ç–≤–∞ –≤–∏–Ω—ã.</p>
      <p>–¢–æ–ª—å–∫–æ <strong>–æ–¥–Ω–æ –ø—Ä–æ—Å—Ç–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –≤ –¥–µ–Ω—å</strong> ‚Äî –º–µ–Ω–µ–µ 2 –º–∏–Ω—É—Ç.</p>
      <p>–ß–µ—Ä–µ–∑ –Ω–µ–¥–µ–ª—é –≤—ã —É–¥–∏–≤–∏—Ç–µ—Å—å, –∫–∞–∫ –º–Ω–æ–≥–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å.</p>
    </div>
    <button class="btn" onclick="showCategorySelect()">–ù–∞—á–∞—Ç—å</button>
  </div>

  <!-- –í—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
  <div id="category" class="screen">
    <h2>–ß—Ç–æ —Ö–æ—á–µ—à—å —É–ª—É—á—à–∏—Ç—å –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å?</h2>
    <button class="btn" onclick="startJourney('–ø–∏—Ç–∞–Ω–∏–µ')"><i class="fas fa-carrot"></i> –ü–∏—Ç–∞–Ω–∏–µ</button>
    <button class="btn" onclick="startJourney('—Å–æ–Ω')"><i class="fas fa-moon"></i> –°–æ–Ω –∏ –æ—Ç–¥—ã—Ö</button>
    <button class="btn" onclick="startJourney('—ç–Ω–µ—Ä–≥–∏—è')"><i class="fas fa-bolt"></i> –≠–Ω–µ—Ä–≥–∏—è</button>
  </div>

  <!-- –û—Å–Ω–æ–≤–Ω–æ–π —ç–∫—Ä–∞–Ω -->
  <div id="main" class="screen">
    <h2>–¢–≤–æ—ë –º–∏–∫—Ä–æ-–¥–µ–π—Å—Ç–≤–∏–µ —Å–µ–≥–æ–¥–Ω—è:</h2>
    <div class="task-text" id="taskText">–ó–∞–≥—Ä—É–∑–∫–∞...</div>

    <div class="tree-container">
      <div class="tree" id="tree">üå±</div>
    </div>

    <button class="btn" onclick="completeTask()">‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ!</button>
    <button class="btn btn-outline" onclick="skipTask()">–ù–µ —Å–µ–≥–æ–¥–Ω—è</button>

    <div class="footer" id="progressHint">–¢—ã –º–æ–∂–µ—à—å –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å ‚Äî –±–µ–∑ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–π.</div>
  </div>

  <!-- –≠–∫—Ä–∞–Ω –ø–æ–¥–¥–µ—Ä–∂–∫–∏ -->
  <div id="support" class="screen">
    <div class="icon"><i class="fas fa-heart"></i></div>
    <h2>–í—Å—ë –≤ –ø–æ—Ä—è–¥–∫–µ üíö</h2>
    <p>–ó–∞–≤—Ç—Ä–∞ –±—É–¥–µ—Ç –Ω–æ–≤–æ–µ –ø—Ä–æ—Å—Ç–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ.</p>
    <p>–¢—ã —É–∂–µ –≥–µ—Ä–æ–π ‚Äî –ø–æ—Ç–æ–º—É —á—Ç–æ —Ö–æ—Ç—è –±—ã **–∑–∞—Ö–æ—Ç–µ–ª(–∞) –Ω–∞—á–∞—Ç—å**.</p>
    <button class="btn" onclick="backToMain()">–•–æ—Ä–æ—à–æ</button>
  </div>

  <!-- –ö–∞—Ä—Ç–∞ –ø—Ä–∏–≤—ã—á–µ–∫ (–ø–æ—Å–ª–µ 3 –¥–Ω–µ–π) -->
  <div id="habitMap" class="screen">
    <h2>–¢—ã —É–∂–µ 3 –¥–Ω—è –≤ –¥–µ–ª–µ! üéâ</h2>
    <p>–í–æ—Ç —Ç–≤–æ–∏ –º–∏–∫—Ä–æ-–ø—Ä–∏–≤—ã—á–∫–∏:</p>
    <div class="habit-map" id="habitList"></div>
    <button class="btn" onclick="backToMain()">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</td>
  </div>
</div>

<script>
  // –ë–∞–∑–∞ –º–∏–∫—Ä–æ-–ø—Ä–∏–≤—ã—á–µ–∫
  const HABITS = {
    –ø–∏—Ç–∞–Ω–∏–µ: [
      "–î–æ–±–∞–≤—å –≤ –æ–±–µ–¥ 1 –≥–æ—Ä—Å—Ç—å –æ–≤–æ—â–µ–π (–¥–∞–∂–µ –∑–∞–º–æ—Ä–æ–∂–µ–Ω–Ω—ã—Ö).",
      "–í—ã–ø–µ–π —Å—Ç–∞–∫–∞–Ω –≤–æ–¥—ã –ø–µ—Ä–µ–¥ –µ–¥–æ–π.",
      "–ó–∞–º–µ–Ω–∏ —Å–ª–∞–¥–∫–∏–π –Ω–∞–ø–∏—Ç–æ–∫ –Ω–∞ –≤–æ–¥—É —Å –ª–∏–º–æ–Ω–æ–º.",
      "–ï—à—å –∏–∑ –º–∞–ª–µ–Ω—å–∫–æ–π —Ç–∞—Ä–µ–ª–∫–∏ ‚Äî —Ç–∞–∫ –Ω–∞—Å—ã—Ç–∏—à—å—Å—è –±—ã—Å—Ç—Ä–µ–µ.",
      "–ü–æ–ª–æ–∂–∏ —Ñ—Ä—É–∫—Ç –Ω–∞ –≤–∏–¥–Ω–æ–µ –º–µ—Å—Ç–æ ‚Äî —Ç—ã –µ–≥–æ —Å—ä–µ—à—å."
    ],
    —Å–æ–Ω: [
      "–ó–∞ 45 –º–∏–Ω—É—Ç –¥–æ —Å–Ω–∞ –≤—ã–∫–ª—é—á–∏ –≤—Å–µ —ç–∫—Ä–∞–Ω—ã.",
      "–ü—Ä–æ—á–∏—Ç–∞–π 1 —Å—Ç—Ä–∞–Ω–∏—Ü—É –∫–Ω–∏–≥–∏ (–Ω–µ —Å —Ç–µ–ª–µ—Ñ–æ–Ω–∞!).",
      "–°–¥–µ–ª–∞–π —Ç–∏—à–µ —Å–≤–µ—Ç –≤ –∫–æ–º–Ω–∞—Ç–µ –∑–∞ —á–∞—Å –¥–æ —Å–Ω–∞.",
      "–õ–æ–∂–∏—Å—å —Å–ø–∞—Ç—å –Ω–∞ 15 –º–∏–Ω—É—Ç —Ä–∞–Ω—å—à–µ –æ–±—ã—á–Ω–æ–≥–æ.",
      "–ü–æ—Å—Ç–∞–≤—å –±—É–¥–∏–ª—å–Ω–∏–∫ –Ω–∞ –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ –≤—Ä–µ–º—è –¥–∞–∂–µ –≤ –≤—ã—Ö–æ–¥–Ω—ã–µ."
    ],
    —ç–Ω–µ—Ä–≥–∏—è: [
      "–°–¥–µ–ª–∞–π 3 –≥–ª—É–±–æ–∫–∏—Ö –≤–¥–æ—Ö–∞, –∫–∞–∫ –±—É–¥—Ç–æ –ø—å—ë—à—å –≥–æ—Ä—è—á–∏–π —á–∞–π.",
      "–ü—Ä–æ–π–¥–∏ 2 –º–∏–Ω—É—Ç—ã –±—ã—Å—Ç—Ä—ã–º —à–∞–≥–æ–º (–¥–∞–∂–µ –ø–æ –∫–≤–∞—Ä—Ç–∏—Ä–µ).",
      "–ü–æ—Å–º–æ—Ç—Ä–∏ –≤ –æ–∫–Ω–æ 60 —Å–µ–∫—É–Ω–¥ ‚Äî –±–µ–∑ —Ç–µ–ª–µ—Ñ–æ–Ω–∞.",
      "–°–∫–∞–∂–∏ —Å–µ–±–µ: ¬´–Ø —É–∂–µ –º–æ–ª–æ–¥–µ—Ü¬ª.",
      "–°–¥–µ–ª–∞–π 1 –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç —Å–µ–±–µ –≤ –∑–µ—Ä–∫–∞–ª–µ."
    ]
  };

  // –•—Ä–∞–Ω–∏–ª–∏—â–µ
  let userData = JSON.parse(localStorage.getItem('microZozhUser')) || {
    category: null,
    completed: [],
    lastTask: null
  };

  // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
  function todayStr() {
    return new Date().toISOString().split('T')[0];
  }

  function getRandomHabit(category, exclude = null) {
    const list = HABITS[category] || HABITS.—ç–Ω–µ—Ä–≥–∏—è;
    let candidates = exclude ? list.filter(h => h !== exclude) : list;
    if (candidates.length === 0) candidates = list;
    return candidates[Math.floor(Math.random() * candidates.length)];
  }

  function updateTree() {
    const tree = document.getElementById('tree');
    const days = userData.completed.length;
    if (days === 0) tree.textContent = 'üå±';
    else if (days < 3) tree.textContent = 'üåø';
    else if (days < 7) tree.textContent = 'üå≥';
    else tree.textContent = 'üå≤';

    tree.classList.remove('grow');
    void tree.offsetWidth; // —Ç—Ä–∏–≥–≥–µ—Ä –∞–Ω–∏–º–∞—Ü–∏–∏
    tree.classList.add('grow');
  }

  function showTask() {
    const today = todayStr();
    const alreadyDone = userData.completed.some(d => d.date === today);

    if (alreadyDone) {
      document.getElementById('taskText').textContent = "–¢—ã —É–∂–µ –≤—ã–ø–æ–ª–Ω–∏–ª(–∞) –∑–∞–¥–∞–Ω–∏–µ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è! –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞ üíö";
      document.querySelector('#main .btn').style.display = 'none';
      return;
    }

    const task = getRandomHabit(userData.category, userData.lastTask);
    userData.lastTask = task;
    document.getElementById('taskText').textContent = task;
    document.querySelector('#main .btn').style.display = 'inline-block';
  }

  // –≠–∫—Ä–∞–Ω—ã
  function showCategorySelect() {
    document.getElementById('intro').classList.remove('active');
    document.getElementById('category').classList.add('active');
  }

  function startJourney(cat) {
    userData.category = cat;
    localStorage.setItem('microZozhUser', JSON.stringify(userData));
    document.getElementById('category').classList.remove('active');
    document.getElementById('main').classList.add('active');
    showTask();
    updateTree();
  }

  function completeTask() {
    const today = todayStr();
    if (!userData.completed.some(d => d.date === today)) {
      userData.completed.push({ date: today, task: userData.lastTask });
      localStorage.setItem('microZozhUser', JSON.stringify(userData));
      
      // –ü–æ–∫–∞–∑ –∫–∞—Ä—Ç—ã –ø–æ—Å–ª–µ 3 –¥–Ω–µ–π
      if (userData.completed.length === 3) {
        showHabitMap();
        return;
      }
      
      alert('–û—Ç–ª–∏—á–Ω–æ! –¢—ã —Å–¥–µ–ª–∞–ª(–∞) –µ—â—ë –æ–¥–∏–Ω –º–∏–∫—Ä–æ-—à–∞–≥ –∫ –∑–¥–æ—Ä–æ–≤–æ–π –∂–∏–∑–Ω–∏ üíö');
      updateTree();
    }
    showTask();
  }

  function skipTask() {
    document.getElementById('main').classList.remove('active');
    document.getElementById('support').classList.add('active');
  }

  function backToMain() {
    document.getElementById('support').classList.remove('active');
    document.getElementById('habitMap').classList.remove('active');
    document.getElementById('main').classList.add('active');
    showTask();
  }

  function showHabitMap() {
    document.getElementById('main').classList.remove('active');
    const listEl = document.getElementById('habitList');
    listEl.innerHTML = '';
    userData.completed.slice(-3).forEach((item, i) => {
      const div = document.createElement('div');
      div.className = 'habit-item';
      div.innerHTML = `<span>–î–µ–Ω—å ${i+1}</span> <span>${item.task}</span>`;
      listEl.appendChild(div);
    });
    document.getElementById('habitMap').classList.add('active');
  }

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
  if (userData.category) {
    document.getElementById('intro').classList.remove('active');
    document.getElementById('main').classList.add('active');
    showTask();
    updateTree();
  }
</script>

</body>
</html>
