<!DOCTYPE html>
<html lang="ru" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>BizStreak ‚Äî –¢–≤–æ–π –ø—É—Ç—å –∫ –±–∏–∑–Ω–µ—Å—É</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    :root {
      --bg: #f0f9ff;
      --text: #0c4a6e;
      --card: white;
      --btn: #0ea5e9;
      --btn-hover: #0284c7;
      --border: #cbd5e1;
      --success: #10b981;
      --warning: #f59e0b;
    }
    [data-theme="dark"] {
      --bg: #0c1427;
      --text: #e0f2fe;
      --card: #121e34;
      --btn: #38bdf8;
      --btn-hover: #0ea5e9;
      --border: #334155;
      --success: #34d399;
      --warning: #fbbf24;
    }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: var(--bg);
      color: var(--text);
      padding: 20px;
      line-height: 1.6;
      transition: background 0.3s;
    }
    .container {
      max-width: 600px;
      margin: 0 auto;
      background: var(--card);
      border-radius: 20px;
      padding: 24px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.05);
      transition: background 0.3s;
    }
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }
    h1 { font-size: 28px; color: var(--text); }
    .subtitle { color: var(--btn); margin-bottom: 16px; }
    .theme-toggle {
      background: none;
      border: none;
      font-size: 20px;
      cursor: pointer;
      color: var(--text);
    }
    .idea-box {
      background: var(--bg);
      border-left: 4px solid var(--btn);
      padding: 12px;
      border-radius: 0 8px 8px 0;
      margin: 16px 0;
      font-style: italic;
      font-size: 15px;
      color: var(--text);
    }
    .streak {
      background: var(--bg);
      color: var(--text);
      padding: 16px;
      border-radius: 14px;
      text-align: center;
      margin: 20px 0;
      font-weight: bold;
      font-size: 22px;
      border: 1px solid var(--border);
    }
    .goal-bar {
      background: var(--bg);
      padding: 12px;
      border-radius: 12px;
      margin: 16px 0;
      font-weight: bold;
      border: 1px solid var(--border);
    }
    .reward, .analysis { text-align: center; margin: 12px 0; font-weight: bold; color: var(--success); }
    .roadmap {
      display: flex;
      justify-content: space-between;
      margin: 20px 0;
      position: relative;
    }
    .roadmap::before {
      content: "";
      position: absolute;
      top: 16px;
      left: 20%;
      right: 20%;
      height: 2px;
      background: var(--border);
      z-index: 1;
    }
    .stage { 
      width: 24px; 
      height: 24px; 
      background: var(--border); 
      border-radius: 50%; 
      z-index: 2;
      position: relative;
    }
    .stage.active { background: var(--success); }
    textarea {
      width: 100%;
      padding: 14px;
      border: 1px solid var(--border);
      border-radius: 12px;
      font-size: 16px;
      min-height: 100px;
      margin: 12px 0;
      background: var(--card);
      color: var(--text);
    }
    .btn {
      padding: 14px;
      border: none;
      border-radius: 12px;
      font-size: 17px;
      font-weight: bold;
      width: 100%;
      cursor: pointer;
      margin: 8px 0;
      transition: background 0.2s;
    }
    .primary { background: var(--btn); color: white; }
    .primary:hover { background: var(--btn-hover); }
    .secondary { background: var(--bg); color: var(--text); border: 1px solid var(--border); }
    .secondary:hover { background: var(--border); }
    .history { margin-top: 30px; }
    .history h2 { margin: 20px 0 12px; }
    .entry {
      padding: 10px 0;
      border-bottom: 1px solid var(--border);
    }
    .date { color: var(--warning); font-size: 14px; }
    .confetti {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 1000;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div>
        <h1>üî• BizStreak</h1>
        <p class="subtitle">–¢–≤–æ–π –ø—É—Ç—å –∫ –±–∏–∑–Ω–µ—Å—É –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –æ–¥–Ω–æ–≥–æ —à–∞–≥–∞ ‚Äî –∫–∞–∂–¥—ã–π –¥–µ–Ω—å</p>
      </div>
      <button class="theme-toggle" onclick="toggleTheme()">üåô</button>
    </div>

    <div class="idea-box" id="dailyIdea"></div>

    <div class="streak" id="streak">üî• –¢–≤–æ—è —Ü–µ–ø–æ—á–∫–∞: <span id="count">0</span> –¥–Ω–µ–π</div>
    <div class="reward" id="reward"></div>

    <div class="goal-bar" id="goalBar">üéØ –¶–µ–ª—å: <span id="goalText">30 –¥–Ω–µ–π</span> ‚Üí [<span id="progressBar">‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë</span>] <span id="progressText">0/30</span></div>

    <div class="roadmap">
      <div class="stage" id="stage1"></div>
      <div class="stage" id="stage2"></div>
      <div class="stage" id="stage3"></div>
      <div class="stage" id="stage4"></div>
    </div>

    <textarea id="action" placeholder="–ß—Ç–æ —Ç—ã —Å–¥–µ–ª–∞–ª —Å–µ–≥–æ–¥–Ω—è –¥–ª—è —Å–≤–æ–µ–≥–æ –±–∏–∑–Ω–µ—Å–∞?"></textarea>
    <button class="btn primary" onclick="logAction()">‚úÖ –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —à–∞–≥</button>
    <button class="btn secondary" onclick="openFears()">–ß—Ç–æ –º–µ–Ω—è –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç?</button>
    <button class="btn secondary" onclick="resetStreak()">üîÑ –Ø –ø—Ä–æ–ø—É—Å—Ç–∏–ª –¥–µ–Ω—å ‚Äî –Ω–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
    <button class="btn secondary" onclick="copyReport()">üìã –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—á—ë—Ç</button>
    <button class="btn secondary" onclick="exportPDF()">üì§ –≠–∫—Å–ø–æ—Ä—Ç –≤ PDF</button>

    <h3 style="margin: 20px 0 10px;">–î–Ω–µ–≤–Ω–∏–∫ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—è</h3>
    <textarea id="journal" placeholder="–ú–æ–∏ –º—ã—Å–ª–∏ —Å–µ–≥–æ–¥–Ω—è..."></textarea>

    <div class="analysis" id="analysis"></div>

    <div class="history">
      <h2>–¢–≤–æ–∏ —à–∞–≥–∏:</h2>
      <div id="historyList"></div>
    </div>
  </div>

  <script>
    // –ë–∞–∑–∞ –∏–¥–µ–π
    const ideas = [
      "–ó–∞–ø–∏—à–∏ 3 –±–∏–∑–Ω–µ—Å-–∏–¥–µ–∏ –∑–∞ 5 –º–∏–Ω—É—Ç.",
      "–ù–∞–ø–∏—à–∏ –æ–¥–Ω–æ–º—É —á–µ–ª–æ–≤–µ–∫—É: ¬´–ú–æ–∂–µ—Ç, —Ç–µ–±–µ –Ω—É–∂–Ω–æ —Ç–æ, —á—Ç–æ —è –¥–µ–ª–∞—é?¬ª",
      "–ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ —É —Ç–µ–±—è —É–∂–µ –µ—Å—Ç—å –ø–µ—Ä–≤—ã–µ 10 –∫–ª–∏–µ–Ω—Ç–æ–≤. –ß—Ç–æ –∏–º –Ω—Ä–∞–≤–∏—Ç—Å—è?",
      "–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π: —á—Ç–æ –º–µ—à–∞–µ—Ç —Ç–µ–±–µ –Ω–∞—á–∞—Ç—å?",
      "–°–æ–∑–¥–∞–π –ø—Ä–æ—Å—Ç–æ–π –ª–µ–Ω–¥–∏–Ω–≥ –∑–∞ 30 –º–∏–Ω—É—Ç (–¥–∞–∂–µ –≤ Notion!).",
      "–ü–æ—Å–ª—É—à–∞–π –ø–æ–¥–∫–∞—Å—Ç –æ –±–∏–∑–Ω–µ—Å–µ ‚Äî –∏ –∑–∞–ø–∏—à–∏ –æ–¥–Ω—É –º—ã—Å–ª—å.",
      "–°–¥–µ–ª–∞–π —à–∞–≥, –¥–∞–∂–µ –µ—Å–ª–∏ –Ω–µ –≤ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–∏. –î–µ–π—Å—Ç–≤–∏–µ > –º–æ—Ç–∏–≤–∞—Ü–∏—è.",
      "–°–ø—Ä–æ—Å–∏ —É –¥—Ä—É–≥–∞: ¬´–ß—Ç–æ –±—ã —Ç—ã –∫—É–ø–∏–ª —É –º–µ–Ω—è?¬ª",
      "–ò–∑—É—á–∏, –∫–∞–∫ –∫—Ç–æ-—Ç–æ –∑–∞–ø—É—Å—Ç–∏–ª –ø–æ—Ö–æ–∂–∏–π –ø—Ä–æ–µ–∫—Ç.",
      "–ü—Ä–æ—Å—Ç–∏ —Å–µ–±—è –∑–∞ –≤—á–µ—Ä–∞—à–Ω—é—é –ø—Ä–æ–∫—Ä–∞—Å—Ç–∏–Ω–∞—Ü–∏—é. –°–µ–≥–æ–¥–Ω—è ‚Äî –Ω–æ–≤—ã–π –¥–µ–Ω—å."
    ];

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    let rawData = JSON.parse(localStorage.getItem('bizstreak'));
    let data = {
      streak: parseInt(rawData?.streak) || 0,
      lastDate: rawData?.lastDate || '',
      actions: Array.isArray(rawData?.actions) ? rawData.actions : [],
      journal: rawData?.journal || '',
      goal: parseInt(rawData?.goal) || 30,
      stage: parseInt(rawData?.stage) || 1
    };
    const today = new Date().toISOString().split('T')[0];

    // –¢–µ–º–∞
    function toggleTheme() {
      const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
      document.documentElement.setAttribute('data-theme', isDark ? 'light' : 'dark');
      localStorage.setItem('theme', isDark ? 'light' : 'dark');
      document.querySelector('.theme-toggle').textContent = isDark ? 'üåô' : '‚òÄÔ∏è';
    }
    const savedTheme = localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
    document.documentElement.setAttribute('data-theme', savedTheme);
    document.querySelector('.theme-toggle').textContent = savedTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';

    // –ü–æ–∫–∞–∑ –∏–¥–µ–∏
    function showRandomIdea() {
      const randomIdea = ideas[Math.floor(Math.random() * ideas.length)];
      document.getElementById('dailyIdea').textContent = `üí° –ò–¥–µ—è –¥–Ω—è: ${randomIdea}`;
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
    function render() {
      // –ü—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –∫ —á–∏—Å–ª—É (–∑–∞—â–∏—Ç–∞ –æ—Ç NaN)
      data.streak = parseInt(data.streak) || 0;
      data.goal = parseInt(data.goal) || 30;
      data.stage = parseInt(data.stage) || 1;

      document.getElementById('count').textContent = data.streak;
      
      let rewardText = '';
      if (data.streak >= 30) rewardText = 'üöÄ –¢—ã ‚Äî –±–∏–∑–Ω–µ—Å–º–µ–Ω! –¢–≤–æ—è –ø—Ä–∏–≤—ã—á–∫–∞ —É—Å—Ç–æ–π—á–∏–≤–∞.';
      else if (data.streak >= 21) rewardText = 'üå± –¢–≤–æ—è –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å–∫–∞—è –ø—Ä–∏–≤—ã—á–∫–∞ –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∞!';
      else if (data.streak >= 7) rewardText = 'üéâ –¢—ã –≤ –∑–æ–Ω–µ —Ä–æ—Å—Ç–∞!';
      document.getElementById('reward').textContent = rewardText;

      const progress = Math.min(data.streak, data.goal);
      const percent = Math.floor((progress / data.goal) * 100);
      const bar = '‚ñà'.repeat(Math.floor(percent / 10)).padEnd(10, '‚ñë');
      document.getElementById('progressBar').textContent = bar;
      document.getElementById('progressText').textContent = `${progress}/${data.goal}`;
      
      const stages = document.querySelectorAll('.stage');
      stages.forEach((stage, i) => {
        stage.classList.toggle('active', i + 1 <= data.stage);
      });

      document.getElementById('journal').value = data.journal;

      const list = document.getElementById('historyList');
      list.innerHTML = data.actions.map(a => 
        `<div class="entry">${a.text}<div class="date">${a.date}</div></div>`
      ).join('');

      if (data.streak > 0 && data.streak % 7 === 0) {
        const actionsText = data.actions.map(a => a.text).join(' ');
        let insight = '–ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ!';
        if (actionsText.includes('–∫–ª–∏–µ–Ω—Ç') || actionsText.includes('–Ω–∞–ø–∏—Å–∞–ª')) {
          insight = '–¢—ã –æ—Ç–ª–∏—á–Ω–æ –æ–±—â–∞–µ—à—å—Å—è —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏ ‚Äî —ç—Ç–æ —Ç–≤–æ—è —Å–∏–ª–∞!';
        } else if (actionsText.includes('–∏–¥–µ—è') || actionsText.includes('–∑–∞–ø–∏—Å–∞–ª')) {
          insight = '–¢—ã –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—à—å –∏–¥–µ–∏ ‚Äî —Ç–µ–ø–µ—Ä—å –≤—ã–±–µ—Ä–∏ –æ–¥–Ω—É –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π!';
        }
        document.getElementById('analysis').textContent = `üß† –ù–µ–¥–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑: ${insight}`;
      } else {
        document.getElementById('analysis').textContent = '';
      }

      if (data.streak >= 5 && data.stage < 2) data.stage = 2;
      if (data.streak >= 15 && data.stage < 3) data.stage = 3;
      if (data.streak >= 30 && data.stage < 4) data.stage = 4;
    }

    // –î–µ–π—Å—Ç–≤–∏–µ
    function logAction() {
      const text = document.getElementById('action').value.trim();
      if (!text) return alert('–ù–∞–ø–∏—à–∏, —á—Ç–æ —Ç—ã —Å–¥–µ–ª–∞–ª!');
      
      if (data.lastDate === today) {
        alert('–¢—ã —É–∂–µ —Å–¥–µ–ª–∞–ª —à–∞–≥ —Å–µ–≥–æ–¥–Ω—è! –ú–æ–ª–æ–¥–µ—Ü!');
        return;
      }

      const yesterday = new Date(Date.now() - 86400000).toISOString().split('T')[0];
      if (data.lastDate === yesterday || data.lastDate === '') {
        data.streak = (parseInt(data.streak) || 0) + 1;
      } else {
        data.streak = 1;
      }
      
      data.lastDate = today;
      data.actions.unshift({ date: today, text });
      if (data.actions.length > 50) data.actions.pop();

      // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–ª—å–∫–æ —á–∏—Å–ª–∞ –∫–∞–∫ —á–∏—Å–ª–∞
      localStorage.setItem('bizstreak', JSON.stringify({
        streak: data.streak,
        lastDate: data.lastDate,
        actions: data.actions,
        journal: data.journal,
        goal: data.goal,
        stage: data.stage
      }));

      document.getElementById('action').value = '';
      render();

      if (data.streak === 7) {
        createConfetti();
      }
      alert('‚úÖ –®–∞–≥ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω! –¢—ã –º–æ–ª–æ–¥–µ—Ü!');
    }

    // –°—Ç—Ä–∞—Ö–∏
    function openFears() {
      const fear = prompt('–ß—Ç–æ —Ç–µ–±—è –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç?\n1. –°—Ç—Ä–∞—Ö –Ω–µ—É–¥–∞—á–∏\n2. –ù–µ—Ç –≤—Ä–µ–º–µ–Ω–∏\n3. –ù–µ –∑–Ω–∞—é —Å —á–µ–≥–æ\n4. –ë–æ—é—Å—å –æ—Å—É–∂–¥–µ–Ω–∏—è');
      const responses = {
        '1': '–°—Ç—Ä–∞—Ö –Ω–µ—É–¥–∞—á–∏ ‚Äî –ø—Ä–∏–∑–Ω–∞–∫, —á—Ç–æ —Ç—ã —Ä–∞—Å—Ç—ë—à—å. –û—à–∏–±–∫–∏ ‚Äî —ç—Ç–æ –¥–∞–Ω–Ω—ã–µ, –∞ –Ω–µ –ø—Ä–æ–≤–∞–ª.',
        '2': '–í—Ä–µ–º—è –ø–æ—è–≤–ª—è–µ—Ç—Å—è, –∫–æ–≥–¥–∞ —Ç—ã –¥–µ–ª–∞–µ—à—å —à–∞–≥. –ù–∞—á–Ω–∏ —Å 5 –º–∏–Ω—É—Ç.',
        '3': '–ù–µ –Ω—É–∂–Ω–æ "–∑–Ω–∞—Ç—å –≤—Å—ë". –ù—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø–µ—Ä–≤–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ.',
        '4': '–¢—ã –Ω–µ –¥–ª—è –≤—Å–µ—Ö. –¢—ã ‚Äî –¥–ª—è —Å–≤–æ–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤.'
      };
      alert(responses[fear] || '–¢—ã —Å–∏–ª—å–Ω–µ–µ, —á–µ–º –¥—É–º–∞–µ—à—å. –°–¥–µ–ª–∞–π —à–∞–≥ ‚Äî –∏ —Å—Ç—Ä–∞—Ö —É–π–¥—ë—Ç.');
    }

    // –°–±—Ä–æ—Å
    function resetStreak() {
      if (confirm('–¢—ã —É–≤–µ—Ä–µ–Ω? –¢–≤–æ—è —Ü–µ–ø–æ—á–∫–∞ –æ–±–Ω—É–ª–∏—Ç—Å—è, –Ω–æ —Ç—ã –Ω–∞—á–Ω—ë—à—å –∑–∞–Ω–æ–≤–æ ‚Äî –∏ —ç—Ç–æ —á–µ—Å—Ç–Ω–æ.')) {
        data.streak = 0;
        data.lastDate = '';
        data.stage = 1;
        localStorage.setItem('bizstreak', JSON.stringify(data));
        render();
        alert('–¢—ã —Å–Ω–æ–≤–∞ –≤ –∏–≥—Ä–µ! –°–¥–µ–ª–∞–π —à–∞–≥ ‚Äî –∏ —Ü–µ–ø–æ—á–∫–∞ –Ω–∞—á–Ω—ë—Ç—Å—è.');
      }
    }

    // –≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á—ë—Ç–∞
    function copyReport() {
      let report = `BizStreak ‚Äî ${data.streak} –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥\n\n`;
      data.actions.forEach(a => {
        report += `‚Ä¢ ${a.date}: ${a.text}\n`;
      });
      if (data.journal) {
        report += `\n–î–Ω–µ–≤–Ω–∏–∫:\n${data.journal}\n`;
      }
      report += `\n#bizstreak #–º–∏–∫—Ä–æ—Å—Ç–∞—Ä—Ç #–±–∏–∑–Ω–µ—Å`;
      
      navigator.clipboard.writeText(report).then(() => {
        alert('üìã –û—Ç—á—ë—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω! –í—Å—Ç–∞–≤—å –≤ –∑–∞–º–µ—Ç–∫–∏, Instagram –∏–ª–∏ Telegram.');
      });
    }

    // –≠–∫—Å–ø–æ—Ä—Ç –≤ PDF
    function exportPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      doc.setFontSize(20);
      doc.text('BizStreak ‚Äî –¢–≤–æ–π –ø—É—Ç—å –∫ –±–∏–∑–Ω–µ—Å—É', 20, 20);
      doc.setFontSize(12);
      doc.text(`–¶–µ–ø–æ—á–∫–∞: ${data.streak} –¥–Ω–µ–π`, 20, 30);
      let y = 40;
      data.actions.slice(0, 20).forEach(a => {
        doc.text(`‚Ä¢ ${a.date}: ${a.text}`, 20, y);
        y += 6;
      });
      if (data.journal) {
        doc.text('–î–Ω–µ–≤–Ω–∏–∫:', 20, y + 10);
        const lines = doc.splitTextToSize(data.journal, 170);
        doc.text(lines, 20, y + 16);
      }
      doc.save('bizstreak-report.pdf');
    }

    // –ö–æ–Ω—Ñ–µ—Ç—Ç–∏
    function createConfetti() {
      const canvas = document.createElement('canvas');
      canvas.className = 'confetti';
      document.body.appendChild(canvas);
      const ctx = canvas.getContext('2d');
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      const pieces = [];
      const colors = ['#f44336', '#e91e63', '#9c27b0', '#673ab7', '#3f51b5', '#2196f3', '#03a9f4', '#00bcd4', '#009688', '#4caf50', '#8bc34a', '#cddc39', '#ffeb3b', '#ffc107', '#ff9800', '#ff5722'];
      for (let i = 0; i < 150; i++) {
        pieces.push({
          x: Math.random() * canvas.width,
          y: -20,
          color: colors[Math.floor(Math.random() * colors.length)],
          radius: Math.random() * 4 + 2,
          speed: Math.random() * 3 + 2,
          angle: Math.random() * Math.PI * 2,
          spin: Math.random() * 0.2 - 0.1
        });
      }
      let time = 0;
      const animate = () => {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        let alive = false;
        pieces.forEach(p => {
          p.y += p.speed;
          p.x += Math.sin(time * 0.01 + p.angle) * 2;
          ctx.fillStyle = p.color;
          ctx.beginPath();
          ctx.arc(p.x, p.y, p.radius, 0, Math.PI * 2);
          ctx.fill();
          if (p.y < canvas.height) alive = true;
        });
        time++;
        if (alive && time < 300) {
          requestAnimationFrame(animate);
        } else {
          canvas.remove();
        }
      };
      animate();
    }

    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–Ω–µ–≤–Ω–∏–∫–∞
    document.getElementById('journal').addEventListener('blur', () => {
      data.journal = document.getElementById('journal').value;
      localStorage.setItem('bizstreak', JSON.stringify(data));
    });

    // –ó–∞–ø—É—Å–∫
    showRandomIdea();
    render();
  </script>
</body>
</html>
